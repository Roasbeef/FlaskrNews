// Generated by CoffeeScript 1.4.0
(function() {

  (function($) {
    var navLinks, past_point, scrollLoad;
    navLinks = $('.nav:eq(0) > li').not('.divider-vertical').slice(0, 2);
    scrollLoad = function() {
      var $cur_info, $new_posts, cursor_string, more_to_load, page_num, speed, url, wantsHot;
      wantsHot = $(navLinks[0]).hasClass('active');
      $cur_info = $('#cur_info').detach();
      cursor_string = $cur_info.data('cur_string');
      page_num = parseInt($cur_info.data('page_num')) + 1;
      more_to_load = $cur_info.data('more_content');
      $new_posts = $('<div>');
      speed = 2000;
      url = '/';
      if (!more_to_load) {
        return false;
      }
      return $new_posts.load("" + url + " .link_wrapper > ", {
        cur_string: cursor_string,
        page_num: page_num,
        sort: wantsHot ? 'hot' : 'new'
      }, function() {
        console.log($new_posts);
        $new_posts.children().hide().appendTo('.link_wrapper').fadeIn(speed);
        return console.log($cur_info);
      });
    };
    past_point = false;
    return $(window).on('scroll', function() {
      var doc_height, load_point, scroll_pos;
      doc_height = $(document).height();
      scroll_pos = $(this).scrollTop();
      load_point = doc_height / 4;
      if (!past_point) {
        if (scroll_pos > load_point) {
          past_point = true;
          console.log('try');
          return $.when(scrollLoad()).then(function() {
            past_point = false;
            return console.log('good loop');
          });
        }
      }
    });
  })(jQuery);

}).call(this);
