// Generated by CoffeeScript 1.4.0
(function() {

  (function($) {
    var $links_container, $navLinks, attachVotes, isLoggedIn, vote;
    $navLinks = $('.nav:eq(0) > li').not('.divider-vertical').slice(0, 2);
    $links_container = $('.link_wrapper');
    isLoggedIn = function() {
      return $('.nav.pull-right li.dropdown').length;
    };
    vote = function(direc, id) {
      var $self;
      $self = $(this);
      $self.fadeOut('fast').parent().siblings().find('i').fadeIn('fast');
      return $.post("/post/_vote/" + id, {
        direction: direc
      }).done(function() {
        var $score_button, score;
        $score_button = $self.closest('.link').find('button');
        score = parseInt($score_button.text());
        return $score_button.text("" + (score + direc) + " Points");
      });
    };
    attachVotes = function() {
      var arrow, _i, _len, _ref, _results;
      _ref = $('[class^="icon-chevron"]');
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        arrow = _ref[_i];
        _results.push($(arrow).on('click', function(e) {
          var $self, direction;
          e.preventDefault();
          $self = $(this);
          direction = $self.hasClass('up') ? 1 : -1;
          return vote.call($self, direction, $self.data('id'));
        }));
      }
      return _results;
    };
    $navLinks.on('click', function(e) {
      var $self;
      e.preventDefault();
      $self = $(this);
      $self.siblings().not('.divider-vertical').removeClass('active');
      return $self.addClass('active');
    });
    $navLinks.on('click', function(e) {
      var url;
      url = $(this).text().toLowerCase() === 'new' ? '/?sort=new' : '/';
      $('html, body').animate({
        scrollTop: 0
      }, 600);
      return $links_container.fadeOut('slow', function() {
        return $.when($links_container.load("" + url + " .link_wrapper > ")).then(function() {
          $links_container.fadeIn('slow', function() {
            if (isLoggedIn()) {
              attachVotes();
            }
          });
        });
      });
    });
    if (isLoggedIn()) {
      attachVotes();
    }
  })(jQuery);

}).call(this);
